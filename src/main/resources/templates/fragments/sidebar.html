<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<nav class="sidebar" th:fragment="sidebar">
    <ul class="sidebar-menu">
        <th:block th:each="item : ${menus}">
            <!-- 1뎁스: URL이 있으면 링크, 없으면 그룹 헤더 -->
            <li th:if="${item.menuUrl != null}">
                <a th:href="@{${item.menuUrl}}" th:classappend="${menu == item.menuCode} ? 'active'">
                    <span th:utext="${item.icon}"></span>
                    <span th:text="${item.menuName}"></span>
                </a>
            </li>
            <li th:if="${item.menuUrl == null}" class="sidebar-group">
                <span class="sidebar-group-label">
                    <span th:utext="${item.icon}"></span>
                    <span th:text="${item.menuName}"></span>
                </span>
                <!-- 2뎁스 -->
                <ul class="sidebar-submenu" th:if="${!item.children.isEmpty()}">
                    <th:block th:each="child : ${item.children}">
                        <li th:if="${child.menuUrl != null}">
                            <a th:href="@{${child.menuUrl}}" th:classappend="${menu == child.menuCode} ? 'active'">
                                <span th:utext="${child.icon}"></span>
                                <span th:text="${child.menuName}"></span>
                            </a>
                        </li>
                        <li th:if="${child.menuUrl == null}" class="sidebar-group">
                            <span class="sidebar-group-label">
                                <span th:utext="${child.icon}"></span>
                                <span th:text="${child.menuName}"></span>
                            </span>
                            <!-- 3뎁스 -->
                            <ul class="sidebar-submenu" th:if="${!child.children.isEmpty()}">
                                <li th:each="grandchild : ${child.children}">
                                    <a th:href="@{${grandchild.menuUrl}}" th:classappend="${menu == grandchild.menuCode} ? 'active'">
                                        <span th:utext="${grandchild.icon}"></span>
                                        <span th:text="${grandchild.menuName}"></span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </th:block>
                </ul>
            </li>
        </th:block>
    </ul>

    <div class="sidebar-bottom">
        <form th:action="@{/logout}" method="post" class="sidebar-logout-form">
            <button type="submit" class="sidebar-logout">
                <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                <span>Logout</span>
            </button>
        </form>
    </div>

    <button class="sidebar-collapse-btn" id="sidebarCollapseBtn" type="button" onclick="toggleSidebarCollapse()">
        <svg class="collapse-icon" viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>
        <svg class="expand-icon" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg>
    </button>
</nav>
</body>
</html>
